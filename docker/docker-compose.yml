services:
  gr-bind-lab:
    image: ${GR_IMAGE:-docker-gr-bind-lab:latest}
    build:
      context: ..
      dockerfile: docker/Dockerfile
    container_name: gr-bind-lab
    hostname: gr-bind-lab
    privileged: true
    env_file:
      - ${TEST_ENV:-../config/test1-baseline.env}
    tmpfs:
      - /tmp:size=256M
    networks:
      net-alpha:
        ipv4_address: 172.30.1.10
      net-beta:
        ipv4_address: 172.30.2.10
    healthcheck:
      test: ["CMD", "mysqladmin", "ping", "-h", "127.0.0.1", "-P", "3306", "--connect-timeout=3"]
      interval: 10s
      timeout: 5s
      retries: 30
      start_period: 60s
networks:
  net-alpha:
    driver: bridge
    ipam:
      config:
        - subnet: 172.30.1.0/24
  net-beta:
    driver: bridge
    ipam:
      config:
        - subnet: 172.30.2.0/24
